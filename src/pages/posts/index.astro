---
import { getCollection } from "astro:content";
import Layout from "@/layouts/Layout.astro";
import formatDate from "@/utils/formatDate";

const posts = (await getCollection("posts")).sort(
	(first, second) => second.data.publishedAt.getTime() - first.data.publishedAt.getTime(),
);
---

<Layout title="Posts â€” Stefan Legg">
  <div class="page-header">
    <h1 class="page-title">Posts</h1>
  </div>

  <div class="post-list">
    {posts.map((post) => (
      <a class="post-row" href={`/posts/${post.slug}`}>
        <div class="post-row-header">
          <h2 class="post-row-title">{post.data.title}</h2>
          <span class="post-row-date">{formatDate(post.data.publishedAt)}</span>
        </div>
        <p class="post-row-desc">{post.data.description}</p>
      </a>
    ))}
  </div>
</Layout>

<style>
  .page-header {
    padding: 56px 0 24px;
    opacity: 0; animation: fade-up 0.8s ease 0.3s forwards;
  }
  .page-title {
    font-family: var(--font-mono); font-size: 14px; font-weight: 500;
    letter-spacing: 4px; text-transform: uppercase;
    color: var(--text-label);
    display: flex; align-items: center; gap: 12px;
  }
  .page-title::after {
    content: ''; flex: 1; height: 1px; background: var(--text-rule);
  }

  .post-list {
    display: flex; flex-direction: column;
    opacity: 0; animation: fade-up 0.8s ease 0.5s forwards;
  }
  .post-row {
    display: block; text-decoration: none; color: inherit;
    padding: 24px 0; border-top: 1px solid var(--text-rule);
    transition: all 0.3s;
  }
  .post-row:hover {
    transform: translateX(12px);
    background: linear-gradient(90deg, var(--accent-glow), transparent 60%);
  }
  .post-row-header {
    display: flex; justify-content: space-between;
    align-items: baseline; gap: 16px; margin-bottom: 8px;
  }
  .post-row-title {
    font-size: 24px; font-weight: 500; color: var(--text); line-height: 1.3;
  }
  .post-row-date {
    font-family: var(--font-mono); font-size: 14px;
    letter-spacing: 2px; color: var(--text-label); flex-shrink: 0;
  }
  .post-row-desc {
    font-size: 20px; font-weight: 300; line-height: 1.7; color: var(--text-body);
  }

  @media (max-width: 600px) {
    .post-row-header { flex-direction: column; gap: 4px; }
  }
</style>
